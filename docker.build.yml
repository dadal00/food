services:
  reverse_proxy:
    build:
      # Assuming proxy repo is sibling
      context: ../rust-rpxy
      dockerfile: ./docker/Dockerfile
      platforms:
        - "linux/arm64"
    image: ${PROXY_IMAGE}

  # App: Custom
  app_rust:
    build:
      context: ./
      dockerfile: ./backend/Dockerfile
      platforms:
        - "linux/arm64"
    image: ${RUST_IMAGE}

  # App: External
  meilisearch:
    build:
      context: ./deploy/meilisearch
    image: dummy_meili:latest

  redis:
    build:
      context: ./deploy/redis
    image: dummy_redis:latest

  # Monitoring
  grafana:
    build:
      context: ./monitor/grafana
    image: dummy_grafana:latest
